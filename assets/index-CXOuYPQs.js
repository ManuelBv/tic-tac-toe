var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class i{constructor(){e(this,"cells"),e(this,"currentPlayer"),e(this,"winner"),e(this,"gameOver"),e(this,"winningLine"),this.cells=[[null,null,null],[null,null,null],[null,null,null]],this.currentPlayer="X",this.winner=null,this.gameOver=!1,this.winningLine=null}makeMove(t,e){if(this.gameOver||!this.isCellEmpty(t,e))return!1;this.cells[t][e]=this.currentPlayer;const i=this.checkWinner();return i?(this.winner=this.currentPlayer,this.gameOver=!0,this.winningLine=i,!0):this.isFull()?(this.gameOver=!0,!0):(this.switchPlayer(),!0)}checkWinner(){const t=this.cells;for(let e=0;e<3;e++)if(t[e][0]&&t[e][0]===t[e][1]&&t[e][1]===t[e][2])return{type:"row",index:e};for(let e=0;e<3;e++)if(t[0][e]&&t[0][e]===t[1][e]&&t[1][e]===t[2][e])return{type:"col",index:e};return t[0][0]&&t[0][0]===t[1][1]&&t[1][1]===t[2][2]?{type:"diagonal",index:0}:t[0][2]&&t[0][2]===t[1][1]&&t[1][1]===t[2][0]?{type:"diagonal",index:1}:null}isCellEmpty(t,e){return null===this.cells[t][e]}isFull(){for(let t=0;t<3;t++)for(let e=0;e<3;e++)if(null===this.cells[t][e])return!1;return!0}switchPlayer(){this.currentPlayer="X"===this.currentPlayer?"O":"X"}reset(){this.cells=[[null,null,null],[null,null,null],[null,null,null]],this.currentPlayer="X",this.winner=null,this.gameOver=!1,this.winningLine=null}}function s(t,e,i){return{x:e*i+i/2,y:t*i+i/2}}class n{constructor(t){e(this,"ctx"),e(this,"canvasWidth"),e(this,"canvasHeight"),e(this,"cellSize");const i=t.getContext("2d");if(!i)throw new Error("Canvas context not available");this.ctx=i,this.canvasWidth=t.width,this.canvasHeight=t.height,this.cellSize=this.canvasWidth/3}clear(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)}drawGrid(){this.ctx.strokeStyle="#374151",this.ctx.lineWidth=3,this.ctx.lineCap="round";for(let t=1;t<3;t++){const e=t*this.cellSize;this.ctx.beginPath(),this.ctx.moveTo(e,0),this.ctx.lineTo(e,this.canvasHeight),this.ctx.stroke()}for(let t=1;t<3;t++){const e=t*this.cellSize;this.ctx.beginPath(),this.ctx.moveTo(0,e),this.ctx.lineTo(this.canvasWidth,e),this.ctx.stroke()}}drawX(t,e,i=1){const n=.2*this.cellSize,{x:r,y:l}=s(t,e,this.cellSize),h=this.cellSize/2-n;this.ctx.strokeStyle=`rgba(59, 130, 246, ${i})`,this.ctx.lineWidth=8,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(r-h,l-h),this.ctx.lineTo(r+h,l+h),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(r+h,l-h),this.ctx.lineTo(r-h,l+h),this.ctx.stroke()}drawO(t,e,i=1){const{x:n,y:r}=s(t,e,this.cellSize),l=.35*this.cellSize;this.ctx.strokeStyle=`rgba(239, 68, 68, ${i})`,this.ctx.lineWidth=8,this.ctx.beginPath(),this.ctx.arc(n,r,l,0,2*Math.PI),this.ctx.stroke()}drawMark(t,e,i,s=1){"X"===t?this.drawX(e,i,s):this.drawO(e,i,s)}drawBoard(t){for(let e=0;e<3;e++)for(let i=0;i<3;i++){const s=t.cells[e][i];s&&this.drawMark(s,e,i)}}drawWinLine(t){this.ctx.strokeStyle="#10B981",this.ctx.lineWidth=10,this.ctx.lineCap="round";let e=0,i=0,s=0,n=0;if("row"===t.type){const r=t.index*this.cellSize+this.cellSize/2;e=.2*this.cellSize,i=r,s=this.canvasWidth-.2*this.cellSize,n=r}else if("col"===t.type){const r=t.index*this.cellSize+this.cellSize/2;e=r,i=.2*this.cellSize,s=r,n=this.canvasHeight-.2*this.cellSize}else if("diagonal"===t.type){const r=.2*this.cellSize;0===t.index?(e=r,i=r,s=this.canvasWidth-r,n=this.canvasHeight-r):(e=this.canvasWidth-r,i=r,s=r,n=this.canvasHeight-r)}this.ctx.beginPath(),this.ctx.moveTo(e,i),this.ctx.lineTo(s,n),this.ctx.stroke()}drawGameOverText(t){this.ctx.font="bold 48px Arial",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="#1F2937",this.ctx.shadowColor="rgba(0, 0, 0, 0.2)",this.ctx.shadowBlur=4,this.ctx.shadowOffsetX=2,this.ctx.shadowOffsetY=2;const e=t?`${t} Wins!`:"It's a Tie!";this.ctx.fillText(e,this.canvasWidth/2,this.canvasHeight/2),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0}render(t,e){this.clear(),this.drawGrid(),this.drawBoard(t),e&&!t.gameOver&&t.isCellEmpty(e.row,e.col)&&this.drawMark(e.player,e.row,e.col,.3),t.gameOver&&t.winningLine&&this.drawWinLine(t.winningLine),t.gameOver&&this.drawGameOverText(t.winner)}}class r{constructor(t){e(this,"board"),e(this,"renderer"),e(this,"canvas"),e(this,"hoveredCell"),this.canvas=t,this.board=new i,this.renderer=new n(t),this.hoveredCell=null}init(){this.setupEventListeners(),this.render()}setupEventListeners(){this.canvas.addEventListener("click",this.handleClick.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this))}handleClick(t){const e=this.canvas.getBoundingClientRect(),i=t.clientX-e.left,s=t.clientY-e.top,{row:n,col:r}=this.pixelToGrid(i,s);this.board.makeMove(n,r)&&this.render()}handleMouseMove(t){if(this.board.gameOver)return;const e=this.canvas.getBoundingClientRect(),i=t.clientX-e.left,s=t.clientY-e.top,{row:n,col:r}=this.pixelToGrid(i,s);this.hoveredCell&&this.hoveredCell.row===n&&this.hoveredCell.col===r||(this.hoveredCell={row:n,col:r},this.render())}handleMouseLeave(){this.hoveredCell&&(this.hoveredCell=null,this.render())}pixelToGrid(t,e){const i=Math.floor(t/this.renderer.cellSize),s=Math.floor(e/this.renderer.cellSize);return{row:Math.max(0,Math.min(2,s)),col:Math.max(0,Math.min(2,i))}}restart(){this.board.reset(),this.hoveredCell=null,this.render()}render(){const t=this.hoveredCell?{row:this.hoveredCell.row,col:this.hoveredCell.col,player:this.board.currentPlayer}:void 0;this.renderer.render(this.board,t)}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("game-canvas"),e=document.getElementById("restart-btn");if(!t)throw new Error("Canvas element not found");if(!e)throw new Error("Restart button not found");const i=new r(t);i.init(),e.addEventListener("click",()=>{i.restart()})});
